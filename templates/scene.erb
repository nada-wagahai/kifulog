<html>
<head>
<meta charset="UTF-8">
<title>scene</title>
<style>
div.kifu {
  //float: left;
  display: inline-block;
}

table.board {
  border-collapse: collapse;
  border-width: 1px;
  border-style: solid;
}

table.board td {
  border-width: 1px;
  border-style: solid;
  width: 31px;
  height: 31px;
  padding: 0px;
  margin: 0px;
  text-align: center;
}

table.board td.second {
  transform: rotate(180deg);
}

table.board td.first {
}

table.board td.step {
  font-weight: bold;
}

table.board td.prev {
  background-color: #E7F1ED;
}

div.prev_step {
  float: left;
}

div.next_step {
  float: right;
}
</style>
</head>
<body>
<div class="kifu">
  <div>指手: <%= step.nil? ? "対局開始" : step.move %></div>
  <div>☖持駒: <% captured_second.each do |p| %><%= p.name %><% end %></div>
  <table class="board">
  <% pieces.each_with_index do |rows, y| %>
    <tr>
    <% rows.each_with_index do |p, x| %>
      <td class="<%= p.order == :SECOND ? "second" : "first" %><% if !step.nil? && step.pos.x == 9-x && step.pos.y == y+1 %> step<% end %><% if !step.nil? && step.prev.x == 9-x && step.prev.y == y+1 %> prev<% end %>"><%= p.name_fig %></td>
    <% end %>
    </tr>
  <% end %>
  </table>
  <div>☗持駒: <% captured_first.each do |p| %><%= p.name %><% end %></div>
  <div>
    <div class="prev_step">
      <% if !step.nil? && step.seq > 0 %><a href="<%= step.seq - 1 %>">前</a><% end %>
    </div>
    <div class="next_step">
      <% if step.nil? %>
        <a href="1">次</a>
      <% elsif !step.finished %>
        <a href="<%= step.seq + 1 %>">次</a>
      <% end %>
    </div>
  </div>
</div>

<div>
  <a href=".">戻る</a>
</div>

<ul>
  <% steps.each do |step| %>
    <li><%= step.kifu_id %>: <%= step.seq %>手</li>
  <% end %>
</ul>
</body>
</html>
